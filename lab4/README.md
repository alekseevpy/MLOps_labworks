## Module 4

В практическом задании данного модуля вам необходимо продемонстрировать навыки практического использования утилиты dvc для работы с данными. В результате выполнения этих заданий вы выполните все основные операции с dvc и закрепите полученные теоретические знания практическими действиями.

Этапы задания:

1. Создайте папку lab4 в корне проекта.
2. Установите git и dvc. Настройте папку проекта для работы с git и dvc.
3. Настройте удаленное хранилище файлов, например на Google Disk или S3.
4. Создайте датасет, например, о пассажирах “Титаника” catboost.titanic().
5. Модифицируйте датасет, в котором содержится информация о классе (“Pclass”),  поле (“Sex”) и возрасте (“Age”) пассажира. Сделайте коммит в git и push в dvc.
6. Создайте новую версию датасета, в котором пропущенные (nan) значения в поле “Age” будут заполнены средним значением. Сделайте коммит в git и push в dvc.
7. Создайте новый признак с использованием one-hot-encoding для строкового признака “Пол” (“Sex”). Сделайте коммит в git и push в dvc.
8. Выполните переключение между всеми созданными версиями датасета.

При правильном выполнении задания и вас появится git репозиторий с опубликованной метаинформацией и папка на Google Disk, в которой хранятся различные версии датасетов.
Вам необходимо подготовить отчет в тех функциональностях которые вы настроили. Дополнительно можно настроить DAG, запуск и версионирование экспериментов, например, с использованием Hydra.

В постановке задачи используется датасет из конкурса “Titanic Disaster”, однако вы можете использовать свои наборы данных, в этом случае в п.п.4-8 необходимо использовать информацию и признаки из вашего датасета.

# Отчет

### Пункт 1-3 - Настройка удаленного хранилища
1. Была создана папка lab4 в корне проекта
2. В корне проекта инициализировал проект в корне репозитория `dvc init`
3. Добавил .dvc/ и конфиг файлы
4. Настроил удалённое хранилище на Google Drive:
    - Зарегистрировался в Google Cloud Console
    - Создал проект
    - Включил Google Drive API
    - Настроил OAuth Consent Screen
    - Создали OAuth client ID и client secret
    - Добавил себя и сокомандников в тестировщики
    - Добавил удаленное хранилище `dvc remote add --default myremote gdrive://1Pm5r95Rpb0lHixTEahjCI-dCrGqgJXXh`
    - Добавил ключи авторизации:
        * `dvc remote modify myremote gdrive_client_id <client-id>`
        * `dvc remote modify myremote gdrive_client_secret <client-secret>`
    - Убрал OAuth-ошибку `dvc remote modify myremote gdrive_acknowledge_abuse true`

### Пункт 4 - Создание датасета
1. Создал встроенный датасет из catboost.datasets
2. Добавил файл в DVC:
    - `dvc add lab4/titanic_raw.csv`
    - `git add lab4/titanic_raw.csv.dvc .gitignore`
    - `git commit -m "Add Titanic raw dataset"`
    - `dvc push`

### Пункт 5 - Модификация датасета
1. Скачал датасет командой `dvc pull -r myremote`
2. Создал скрипт modify_dataset.py, в котором с помощью Pandas оставил нужные поля
3. Применил скрипт командой `python -m modify_dataset`
4. Сохранил новую версию командой `dvc push -r myremote`

### Пункт 6 - Модификация датасета (fillna)
1. Открыл на другой машине репозиторий
2. Установил в `.dvc/config` нужные параметры для доступа к gdrive
3. Скачал датасет командой `dvc pull`
4. Добавил в скрипт modify_dataset.py изменение датасета, в котором с помощью Pandas вычислил среднее значение по колонке Age и заполнил NaN значения вычисленным
5. Применил скрипт командой `python -m modify_dataset`
6. Добавил новую версию датасета локально командой `dvc add .`
7. Сохранил новую версию командой `dvc push`

### Пункт 7 - Создание нового признака
1. Загрузил ранее сохраненный датасет
2. Заполнил пропущенные значения
3. Сделал One-hot encoding для признака "Sex"
4. Сохранил обновленный датасет и обновил данные в DVC:
    - `dvc add lab4/titanic_raw.csv`
    - `git add lab4/titanic_raw.csv.dvc lab4/modify_dataset.py`
    - `git commit -m "Добавлен one-hot encoding для 'Sex'`
    - `dvc push`

### Выполнение пункта 8 - переключение между всеми созданными версиями датасета
1. Выполнение команды "dvc pull" - скачивание из удаленного хранилища все файлы данных, указанные в конфигурации.
2. Просмотр истории коммитов "git log --oneline" - получение уникальных идентификаторов коммита, чтобы по ним в дальнейшем получать версии датасета из dvc.
3. Переключение на конкретную версию "git checkout <идентификатор_коммита>" - переключение файлов кода на указанный коммит. В нашем случае это: "0e2acf6" - чистый набор данных, "a1e108f" - модифицированный набор данных, "8cb0aa9" - заполнение nan значений, "d417f62" - использование one-hot-encoding.
4. Синхронизация данных "dvc checkout" - синхронизация данных в рабочей директории с текущей версией из dvc
